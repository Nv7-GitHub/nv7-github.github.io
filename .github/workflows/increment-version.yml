name: increment-version
on: push
jobs:
  increment-version:
     name: increment-version
     runs-on: macos-latest
     steps:
       - name: Checkout code
         uses: actions/checkout@v2
         
       - name: Get Version
         run: THING=$(cat docs/index.html | pcregrep -o1 '\?v=([0-9]+)')
       
       - name: Increment Version
         run: THING=$((THING + 1))
       
       - name: Echo
         run: echo $THING
       
       - name: Save Version
         run: sed -i '' "s/\?v=1/?v=${THING}/g" docs/index.html
       
       - name: Set Locals
         run: git config --local user.email "action@github.com"
       - name: Set Locals
         run: git config --local user.name "GitHub Action"
         
       - name: Git Add
         run: git add docs/index.html
       
       - name: Commit
         run: git commit -m "Increment Version" -a
         
       - name: Push changes
         uses: ad-m/github-push-action@master
         with:
           github_token: ${{ secrets.GITHUB_TOKEN }}
           branch: ${{ github.ref }}
